# SendCloud API Integration Guide for VCANSHIP

This guide will help you resolve the SendCloud API `/shipping-price` endpoint issue and integrate real shipping rates into your VCANSHIP platform.

## ðŸš¨ Current Issue
Your SendCloud `/shipping-price` API endpoint is returning no prices. SendCloud support needs:
1. **The full API request** you are sending
2. **The specific carrier** you're trying to use

## ðŸ“ Files Created
- `sendcloud-api.ts` - Complete SendCloud API integration
- `sendcloud-test.ts` - Test tool to generate debug information
- `SENDCLOUD_INTEGRATION_GUIDE.md` - This guide

## ðŸ”§ Quick Setup

### Step 1: Add Your Credentials
Edit `sendcloud-test.ts` and replace:
```typescript
const SENDCLOUD_CONFIG: SendCloudConfig = {
    publicKey: 'YOUR_SENDCLOUD_PUBLIC_KEY', // Replace with your actual key
    secretKey: 'YOUR_SENDCLOUD_SECRET_KEY', // Replace with your actual key
    baseUrl: 'https://panel.sendcloud.sc/api/v2'
};
```

### Step 2: Test the Integration
Open your browser console and run:
```javascript
// Load the test file first, then run:
testSendCloud()
```

Or for quick debug info:
```javascript
quickSendCloudTest()
```

### Step 3: Get Debug Info for SendCloud Support
Run this to get the exact information SendCloud support needs:
```javascript
console.log(sendCloudDebug())
```

## ðŸ“§ What to Send to SendCloud Support

Copy the output from `sendCloudDebug()` and send it to SendCloud support. It includes:

1. **Full API Request**: Exact URL, headers, and body
2. **Your Account Details**: Public key and configuration
3. **Test Data**: Sample UK domestic shipment
4. **Expected vs Actual Behavior**: Clear problem description

## ðŸ” Common Issues & Solutions

### Issue: "No shipping methods returned"
**Cause**: Your account might not have carriers configured for the route
**Solution**: Ask SendCloud support which carriers are available for your account

### Issue: "Authentication failed"
**Cause**: Incorrect API credentials
**Solution**: Verify your public/secret keys in SendCloud dashboard

### Issue: "Invalid country code"
**Cause**: Using 3-letter codes instead of 2-letter ISO codes
**Solution**: Use 'GB' not 'GBR', 'US' not 'USA', etc.

### Issue: "Invalid postal code format"
**Cause**: Postal code doesn't match country format
**Solution**: Ensure UK postcodes are like 'SW1A 1AA', US like '10001'

## ðŸš€ Integration with VCANSHIP Parcel Service

Once SendCloud is working, integrate it with your parcel service:

```typescript
// In parcel.ts, replace mock quotes with real SendCloud data
import { getVCANSHIPShippingRates } from './sendcloud-api.js';

async function getRealShippingQuotes(formData) {
    try {
        const shippingMethods = await getVCANSHIPShippingRates(
            formData.sender,
            formData.recipient,
            formData.parcel,
            SENDCLOUD_CONFIG
        );
        
        // Convert SendCloud format to VCANSHIP format
        return shippingMethods.map(method => ({
            id: method.id.toString(),
            carrierName: method.carrier,
            carrierType: method.name,
            totalCost: method.price,
            estimatedTransitTime: method.estimated_delivery_date || '2-3 days',
            // ... other fields
        }));
    } catch (error) {
        console.error('Failed to get real quotes:', error);
        // Fallback to mock data
        return getMockQuotes();
    }
}
```

## ðŸ“‹ SendCloud Support Checklist

When contacting SendCloud support, include:

- [ ] Full API request (from debug output)
- [ ] Your account public key
- [ ] Specific route you're testing (UK to UK in the example)
- [ ] Confirmation you're using SendCloud contracts (not direct carrier contracts)
- [ ] Request for list of available carriers for your account

## ðŸ”„ Next Steps

1. **Immediate**: Run the test and send debug info to SendCloud support
2. **After SendCloud fixes the issue**: Integrate real rates into parcel service
3. **Future**: Add label generation, tracking, and other SendCloud features

## ðŸ’¡ Pro Tips

- Test with simple UK domestic routes first
- Always validate postal codes before sending to API
- Use 2-letter ISO country codes (GB, US, DE, etc.)
- Keep API credentials secure (use environment variables in production)
- Log all API requests/responses for debugging

## ðŸ†˜ Need Help?

If you need assistance with the integration:
1. Check the browser console for detailed error messages
2. Verify your API credentials in SendCloud dashboard
3. Test with the provided UK domestic example first
4. Contact SendCloud support with the debug information

---

**Remember**: The key to resolving your issue is providing SendCloud support with the exact API request details generated by these tools.